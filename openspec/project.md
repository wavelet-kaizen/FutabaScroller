# Project Context

## Purpose
FutabaScroller ã¯ã€åŒè‘‰â˜†ã¡ã‚ƒã‚“ã­ã‚‹ï¼ˆFutabaï¼‰ã®ç”»åƒæ²ç¤ºæ¿ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ã€æŠ•ç¨¿ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã«åŸºã¥ã„ã¦è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã§ã™ã€‚ãƒ¬ã‚¹ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’è§£æã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠã—ãŸé–‹å§‹åœ°ç‚¹ã¨å†ç”Ÿé€Ÿåº¦ã§ã€ã‚¹ãƒ¬ãƒƒãƒ‰ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å±•é–‹ã•ã‚Œã¦ã„ãæ§˜å­ã‚’å†ç¾ã—ã¾ã™ã€‚

ä¸»ãªæ©Ÿèƒ½:
- ã‚¹ãƒ¬ãƒƒãƒ‰å†…ã®å…¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£
- HTMLå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã§é–‹å§‹ä½ç½®ï¼ˆãƒ¬ã‚¹ç•ªå·/æ—¥æ™‚/No.ï¼‰ã¨é€Ÿåº¦ã€è¿½åŠ ã‚¹ãƒ¬ãƒƒãƒ‰URLã‚’å…¥åŠ›
- è¿½åŠ ã‚¹ãƒ¬ãƒƒãƒ‰ã®DOMçµ±åˆã¨ No. æ˜‡é †ãƒãƒ¼ã‚¸ï¼ˆé‡è¤‡No.ã¯é™¤å¤–ï¼‰
- 4ã¤ã®ãƒ­ã‚°å½¢å¼ã«å¯¾å¿œï¼ˆãµãŸã°æœ¬å®¶ã€ãµãŸã‚¯ãƒ­ã€tsumanne.netã€Futafutaï¼‰
- ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ™ãƒ¼ã‚¹ã§è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
- èµ·å‹•æ™‚ã¯ä¸€æ™‚åœæ­¢çŠ¶æ…‹ã§æº–å‚™ã—ã€xã‚­ãƒ¼ã§é–‹å§‹
- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã«ã‚ˆã‚‹é€Ÿåº¦èª¿æ•´
- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°/ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º

## Tech Stack
- **TypeScript (5.7+)** - å‹å®‰å…¨ãªé–‹ç™ºã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰
- **esbuild** - é«˜é€Ÿãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼ˆTypeScript â†’ IIFE å½¢å¼ã«ãƒãƒ³ãƒ‰ãƒ«ï¼‰
- **Jest + jsdom** - è‡ªå‹•ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ»UIãƒ»ãƒ‘ãƒ¼ã‚µãƒ¼ã‚’ãƒ†ã‚¹ãƒˆï¼‰
- **ESLint** - ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ï¼ˆTypeScript ESLint ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä½¿ç”¨ï¼‰
- **Prettier** - ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ï¼ˆ4ã‚¹ãƒšãƒ¼ã‚¹ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼‰
- **Node.js** - é–‹ç™ºãƒ„ãƒ¼ãƒ«ï¼ˆå‹ãƒã‚§ãƒƒã‚¯ã€ãƒ“ãƒ«ãƒ‰ã€ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼‰
- **Bookmarklet** - é…å¸ƒå½¢å¼ï¼ˆãƒãƒ³ãƒ‰ãƒ«å¾Œã® IIFE ã‚’å˜ä¸€ URL ã«å¤‰æ›ï¼‰

## Project Conventions

### Code Style
- **è¨€èª**: TypeScriptï¼ˆå³æ ¼ãªå‹ãƒã‚§ãƒƒã‚¯æœ‰åŠ¹ï¼‰
- **ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ**: 4ã‚¹ãƒšãƒ¼ã‚¹ï¼ˆã‚¿ãƒ–ä¸å¯ï¼‰
- **å¤‰æ•°å®£è¨€**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ `const`ã€å¯å¤‰ãªçŠ¶æ…‹ã®ã¿ `let` ã‚’ä½¿ç”¨
- **é–¢æ•°å**: å‘½ä»¤å½¢ã®è‹±èªåï¼ˆä¾‹: `captureResponses`, `scrollToClosestResponse`ï¼‰
- **ã‚¯ãƒ©ã‚¹å**: PascalCaseï¼ˆä¾‹: `ScrollController`, `TimelineCalculator`ï¼‰
- **ãƒ•ã‚¡ã‚¤ãƒ«å**: snake_caseï¼ˆä¾‹: `response_update_manager.ts`, `speed_overlay.ts`ï¼‰
- **å‹å®šç¾©**: æ˜ç¤ºçš„ãªå‹æ³¨é‡ˆã‚’æ¨å¥¨ã€å¿…è¦ã«å¿œã˜ã¦ `types.ts` ã«å…±é€šå‹ã‚’é›†ç´„
- **é…åˆ—ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**: è¤‡æ•°è¡Œã®å ´åˆã¯æœ«å°¾ã‚«ãƒ³ãƒã‚’ä»˜ã‘ã‚‹
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ†ã‚­ã‚¹ãƒˆ**: ã™ã¹ã¦æ—¥æœ¬èªï¼ˆFutaba ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«åˆã‚ã›ã‚‹ï¼‰
- **ã‚»ãƒ¬ã‚¯ã‚¿**: å…·ä½“æ€§ã‚’ä¿ã¤ï¼ˆä¾‹: `body > div.thre table .cnw`ï¼‰
- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: Prettier ã§è‡ªå‹•æ•´å½¢ï¼ˆ`npm run format`ï¼‰
- **Lint**: ESLint ã§ã‚³ãƒ¼ãƒ‰å“è³ªã‚’ãƒã‚§ãƒƒã‚¯ï¼ˆ`npm run lint`ã€ã‚³ãƒŸãƒƒãƒˆå‰ã« `npm run lint:fix`ï¼‰

### Architecture Patterns
- **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ**: TypeScript ã§ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ï¼ˆ`src/` é…ä¸‹ï¼‰ã—ã€esbuild ã§ IIFE ã«ãƒãƒ³ãƒ‰ãƒ«
- **ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†é›¢**: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆ`domain/`ï¼‰ã€UIåˆ¶å¾¡ï¼ˆ`ui/`ï¼‰ã€DOMæ“ä½œï¼ˆ`dom/`ï¼‰ã€ãƒ‘ãƒ¼ã‚µãƒ¼ï¼ˆ`parsers/`ï¼‰ã‚’åˆ†é›¢
- **ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ**: çŠ¶æ…‹ã¨æŒ¯ã‚‹èˆã„ã‚’æŒã¤ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã‚¯ãƒ©ã‚¹åŒ–ï¼ˆä¾‹: `ScrollController`, `ResponseUpdateManager`ï¼‰
- **ä¾å­˜æ€§æ³¨å…¥**: ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ä¾å­˜ã‚’æ³¨å…¥ã—ã¦ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ã‚’ç¢ºä¿
- **ã‚¿ã‚¤ãƒãƒ¼ãƒ™ãƒ¼ã‚¹**: `setInterval()` ã§500msæ¯ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’æ›´æ–°
- **ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•**: ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã¯ `keydown` ã‚¤ãƒ™ãƒ³ãƒˆã§å‡¦ç†
- **é€Ÿåº¦å¤‰æ›´æ™‚ã®åŸºæº–æ™‚åˆ»ä¿æŒ**: `ScrollController` ãŒé€Ÿåº¦å¤‰æ›´æ™‚ã®åŸºæº–ç‚¹ã‚’ç®¡ç†ã—ã€`TimelineCalculator` ã«çŠ¶æ…‹ã‚’æ¸¡ã—ã¦è¨ˆç®—
- **å†å®Ÿè¡Œã®åˆæœŸåŒ–**: ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†å®Ÿè¡Œæ™‚ã¯ä¸€æ™‚åœæ­¢ãƒ»é€Ÿåº¦ãƒ»ãƒãƒ¼ãƒªãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆã—ã€é‡è¤‡No.ã¯ãƒãƒ¼ã‚¸æ®µéšã§é™¤å¤–
- **ãƒ¬ã‚¹ã‚­ãƒ£ãƒ—ãƒãƒ£**: `.thre` ã® `childNodes` ã‚’é †ç•ªã«èµ°æŸ»ã—ã€`.cnw` ã¨ `.cno` ã‚’ä¸¡æ–¹å«ã‚€ãƒãƒ¼ãƒ‰ç¾¤ã‚’ãƒ¬ã‚¹ã¨ã¿ãªã™ã€‚tableå½¢å¼ãƒ¬ã‚¹ã«åŠ ãˆã¦ Futafuta ã®étableã‚¹ãƒ¬ä¸»æŠ•ç¨¿ã‚‚æ¤œå‡ºã—ã€ãµãŸã°æœ¬å®¶ãƒšãƒ¼ã‚¸ã«Futafutaã‚’ãƒãƒ¼ã‚¸ã—ãŸæ··åœ¨æ§‹æˆã§ã‚‚ `captureResponses()` ãŒå…¨ãƒ¬ã‚¹ã‚’å–å¾—ã§ãã‚‹

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ :
```
src/
â”œâ”€â”€ index.ts              # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼ˆIIFE ãƒ©ãƒƒãƒ‘ãƒ¼ï¼‰
â”œâ”€â”€ main.ts               # ãƒ¡ã‚¤ãƒ³å‡¦ç†ï¼ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ„ã¿ç«‹ã¦ï¼‰
â”œâ”€â”€ types.ts              # å…±é€šå‹å®šç¾©
â”œâ”€â”€ domain/               # ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ timeline.ts       # TimelineCalculatorï¼ˆæ™‚åˆ»è¨ˆç®—ï¼‰
â”‚   â”œâ”€â”€ response_update_manager.ts  # ãƒ¬ã‚¹æ›´æ–°ç®¡ç†
â”‚   â”œâ”€â”€ validation.ts     # å…¥åŠ›å€¤æ¤œè¨¼
â”‚   â””â”€â”€ start_position.ts # é–‹å§‹ä½ç½®è§£æ±ºï¼ˆãƒ¬ã‚¹ç•ªå·/æ—¥æ™‚/No.ï¼‰
â”œâ”€â”€ ui/                   # UIåˆ¶å¾¡
â”‚   â”œâ”€â”€ scroller.ts       # ScrollControllerï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ¶å¾¡ï¼‰
â”‚   â”œâ”€â”€ prompt.ts         # ï¼ˆãƒ¬ã‚¬ã‚·ãƒ¼ï¼‰promptãƒ™ãƒ¼ã‚¹ã®è¨­å®šå…¥åŠ›
â”‚   â”œâ”€â”€ input_form.ts     # HTMLãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
â”‚   â”œâ”€â”€ loading_overlay.ts # ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
â”‚   â”œâ”€â”€ speed_overlay.ts  # é€Ÿåº¦ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
â”‚   â””â”€â”€ status_overlay.ts # ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
â”œâ”€â”€ dom/                  # DOMæ“ä½œ
â”‚   â”œâ”€â”€ capture.ts        # ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚­ãƒ£ãƒ—ãƒãƒ£
â”‚   â”œâ”€â”€ response_nodes.ts # ãƒ¬ã‚¹ãƒãƒ¼ãƒ‰ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼ˆå½¢å¼åˆ¤å®šã«ä¾å­˜ã—ãªã„ï¼‰
â”‚   â”œâ”€â”€ scroll.ts         # ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å‡¦ç†
â”‚   â”œâ”€â”€ selectors.ts      # CSS ã‚»ãƒ¬ã‚¯ã‚¿
â”‚   â”œâ”€â”€ merge.ts          # è¿½åŠ ã‚¹ãƒ¬ãƒƒãƒ‰ã®DOMçµ±åˆ
â”‚   â””â”€â”€ thread_fetcher.ts # å¤–éƒ¨ã‚¹ãƒ¬ãƒƒãƒ‰ã®å–å¾—ã¨å½¢å¼åˆ¤å®š
â”œâ”€â”€ parsers/              # ãƒ‘ãƒ¼ã‚µãƒ¼
â”‚   â””â”€â”€ timestamp.ts      # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—è§£æ
â””â”€â”€ utils/                # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
    â””â”€â”€ hash.ts           # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒƒã‚·ãƒ¥è¨ˆç®—ï¼ˆãƒ¬ã‚¹åŒä¸€æ€§åˆ¤å®šï¼‰
```

ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ:
1. **ScrollController** (`src/ui/scroller.ts:23`): ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«åˆ¶å¾¡ã€ä¸€æ™‚åœæ­¢/å†é–‹ã€é€Ÿåº¦èª¿æ•´ã€åŸºæº–æ™‚åˆ»ç®¡ç†
2. **ResponseUpdateManager** (`src/domain/response_update_manager.ts:16`): 10ç§’æ¯ã«ãƒ¬ã‚¹æ›´æ–°ã‚’æ¤œå‡º
3. **TimelineCalculator** (`src/domain/timeline.ts`): ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ãªã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¨ˆç®—ï¼ˆTimelineState ã‚’å—ã‘å–ã‚Šç¾åœ¨æ™‚åˆ»ã‚’è¨ˆç®—ï¼‰
4. **SpeedOverlay / StatusOverlay** (`src/ui/*.ts`): ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤UIæç”»

### Testing Strategy
- **è‡ªå‹•ãƒ†ã‚¹ãƒˆ**: Jest + jsdom ã§å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆ`npm test`ï¼‰
  - **ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯**: `tests/domain/timeline.test.ts`, `tests/domain/validation.test.ts`, `tests/domain/response_update_manager.test.ts`
  - **UIåˆ¶å¾¡**: `tests/ui/scroller.test.ts`, `tests/ui/prompt.test.ts`
  - **ãƒ‘ãƒ¼ã‚µãƒ¼**: `tests/parsers/timestamp.test.ts`
  - **DOMæ“ä½œ**: `tests/dom/capture.test.ts`
  - **çµ±åˆ**: `tests/main.test.ts`
- **ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰**:
  - `npm test` - å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
  - `npm run test:watch` - Watch ãƒ¢ãƒ¼ãƒ‰
  - `npm run test:coverage` - ã‚«ãƒãƒ¬ãƒƒã‚¸è¨ˆæ¸¬
- **æ‰‹å‹•ãƒ†ã‚¹ãƒˆ** (ãƒ–ãƒ©ã‚¦ã‚¶æ¤œè¨¼):
  - Futaba ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’é–‹ã
  - DevTools ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã« `dist/futaba_scroller.js` ã‚’è²¼ã‚Šä»˜ã‘
  - HTMLå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã§é–‹å§‹ä½ç½®ï¼ˆãƒ¬ã‚¹ç•ªå·/æ—¥æ™‚/No.ï¼‰ã¨é€Ÿåº¦ã‚’æŒ‡å®šã—ã€é–‹å§‹ã¯xã‚­ãƒ¼ã§è¡Œã†
  - è¿½åŠ ã‚¹ãƒ¬ãƒƒãƒ‰URLã‚’1ä»¶/è¤‡æ•°ä»¶æŒ‡å®šã—ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã¨No.æ˜‡é †ãƒãƒ¼ã‚¸ãƒ»é‡è¤‡é™¤å¤–ã‚’ç¢ºèª
  - ãµãŸã°æœ¬å®¶/ãµãŸã‚¯ãƒ­/tsumanneãƒ­ã‚°ã‚’çµ„ã¿åˆã‚ã›ã¦ãƒãƒ¼ã‚¸ã—ã€å‰Šé™¤ãƒ¬ã‚¹é™¤å¤–ã¨ãƒ©ãƒƒãƒ‘ãƒ¼ä¿æŒã‚’ç¢ºèª
  - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼ˆä¸€æ™‚åœæ­¢/é€Ÿåº¦èª¿æ•´ï¼‰ã®å‹•ä½œç¢ºèª

### Git Workflow
- **ãƒ¡ã‚¤ãƒ³ãƒ–ãƒ©ãƒ³ãƒ**: `master`
- **ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: æ—¥æœ¬èªã§ç°¡æ½”ã«ï¼ˆä¾‹: ã€Œãƒ¬ã‚¹ã®å®šæœŸæ›´æ–°æ©Ÿèƒ½ã‚’å®Ÿè£…ã€ï¼‰
- **ãƒªãƒªãƒ¼ã‚¹**: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¿ã‚°ï¼ˆä¾‹: `version2.0`ï¼‰
- **Claude Code å”åƒ**: ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã« `ğŸ¤– Generated with [Claude Code]` ãŠã‚ˆã³ `Co-Authored-By: Claude <noreply@anthropic.com>` ã‚’å«ã‚€

## Domain Context

**åŒè‘‰â˜†ã¡ã‚ƒã‚“ã­ã‚‹ï¼ˆFutaba Channelï¼‰**:
- æ—¥æœ¬ã®åŒ¿åç”»åƒæ²ç¤ºæ¿
- ãƒ¬ã‚¹ï¼ˆè¿”ä¿¡ï¼‰ã«ã¯ `YY/MM/DD(æ›œæ—¥)HH:MM:SS` å½¢å¼ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãŒä»˜ã
- DOMæ§‹é€ : `.cnw` ã‚¯ãƒ©ã‚¹è¦ç´ ã«ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãŒå«ã¾ã‚Œã‚‹
- ã‚»ãƒ¬ã‚¯ã‚¿ä¾‹: `body > div.thre table .cnw`

**ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **:
```
currentThreadTime = threadStartTime + (Date.now() - startTime) * speedMultiplier
```
500msæ¯ã« `response.timestamp â‰¤ currentThreadTime` ã®æœ€æ–°ãƒ¬ã‚¹ã‚’æ¢ã—ã¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«

## Important Constraints

1. **ãƒ“ãƒ«ãƒ‰ãƒ•ãƒ­ãƒ¼å¿…é ˆ**: TypeScript ã§é–‹ç™º â†’ esbuild ã§ãƒãƒ³ãƒ‰ãƒ« â†’ `dist/` ã«å‡ºåŠ›
2. **è‡ªå·±å®Œçµå‹**: ãƒãƒ³ãƒ‰ãƒ«å¾Œã¯å¤–éƒ¨ä¾å­˜ãªã—ï¼ˆIIFE å½¢å¼ã®å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
3. **CSP-safe**: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã«é•åã—ãªã„ï¼ˆæ—¢å­˜ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§å®Ÿè¡Œï¼‰
4. **ãƒŸãƒ‹ãƒ•ã‚¡ã‚¤ã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰æ™‚ã« esbuild ãŒè‡ªå‹•åœ§ç¸®ï¼ˆ`npm run build`ï¼‰
5. **é…å¸ƒå½¢å¼**:
   - `dist/futaba_scroller.js` - ãƒãƒ³ãƒ‰ãƒ«æ¸ˆã¿ JavaScriptï¼ˆé–‹ç™ºãƒ»æ¤œè¨¼ç”¨ï¼‰
   - `dist/futaba_scroller.bookmarklet.txt` - `javascript:...` å½¢å¼ã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆURL
6. **ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§**: ES2020 ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼ˆChromium/Firefox/Safari ã®æœ€æ–°ç‰ˆï¼‰
7. **å‹å®‰å…¨æ€§**: TypeScript strict ãƒ¢ãƒ¼ãƒ‰å¿…é ˆï¼ˆ`npm run type-check` ã§æ¤œè¨¼ï¼‰
8. **ã‚½ãƒ¼ã‚¹ç·¨é›†ã®ç¦æ­¢**: `dist/` ã¯è‡ªå‹•ç”Ÿæˆç‰©ã®ãŸã‚ç›´æ¥ç·¨é›†ã—ãªã„ï¼ˆ`src/` ã®ã¿ç·¨é›†ï¼‰

## External Dependencies

ãªã—ï¼ˆå®Œå…¨ã«è‡ªå·±å®Œçµå‹ã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼‰

## Development Workflow

### é–‹ç™ºã‚µã‚¤ã‚¯ãƒ«
1. `src/` é…ä¸‹ã® TypeScript ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
2. `npm run type-check` - å‹ãƒã‚§ãƒƒã‚¯
3. `npm run lint` - ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
4. `npm test` - è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
5. `npm run build` - ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ï¼ˆã¾ãŸã¯ `npm run build:dev` ã§é–‹ç™ºãƒ“ãƒ«ãƒ‰ï¼‰
6. `dist/futaba_scroller.js` ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§æ‰‹å‹•ãƒ†ã‚¹ãƒˆ

### ä¸»è¦ã‚³ãƒãƒ³ãƒ‰
- **å‹ãƒã‚§ãƒƒã‚¯**: `npm run type-check` - TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã§å‹æ¤œè¨¼ï¼ˆãƒ“ãƒ«ãƒ‰å‰ã«è‡ªå‹•å®Ÿè¡Œï¼‰
- **ãƒ“ãƒ«ãƒ‰**: `npm run build` - ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ï¼ˆãƒŸãƒ‹ãƒ•ã‚¡ã‚¤æœ‰åŠ¹ï¼‰
- **é–‹ç™ºãƒ“ãƒ«ãƒ‰**: `npm run build:dev` - ã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ä»˜ããƒ“ãƒ«ãƒ‰ï¼ˆãƒŸãƒ‹ãƒ•ã‚¡ã‚¤ç„¡åŠ¹ï¼‰
- **ãƒ†ã‚¹ãƒˆ**: `npm test` - Jest ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- **Lint**: `npm run lint` - ESLint ã§ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
- **Lint ä¿®æ­£**: `npm run lint:fix` - ESLint ã§è‡ªå‹•ä¿®æ­£
- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: `npm run format` - Prettier ã§ã‚³ãƒ¼ãƒ‰æ•´å½¢
- **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç¢ºèª**: `npm run format:check` - Prettier ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç¢ºèªã®ã¿

### ãƒ“ãƒ«ãƒ‰æˆæœç‰©
- `dist/futaba_scroller.js` - ãƒãƒ³ãƒ‰ãƒ«æ¸ˆã¿ JavaScriptï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã§å®Ÿè¡Œå¯èƒ½ï¼‰
- `dist/futaba_scroller.bookmarklet.txt` - ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆURLï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã«ç™»éŒ²ï¼‰

### æ¨å¥¨ã‚¨ãƒ‡ã‚£ã‚¿è¨­å®š
- VSCode ã®å ´åˆ: TypeScript/ESLint/Prettier æ‹¡å¼µæ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–
- ä¿å­˜æ™‚ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè‡ªå‹•å®Ÿè¡Œã‚’æ¨å¥¨
