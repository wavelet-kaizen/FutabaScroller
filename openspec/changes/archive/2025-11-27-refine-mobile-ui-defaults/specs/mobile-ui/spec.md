# mobile-ui Specification Deltas

## MODIFIED Requirements

### Requirement: UI表示モード選択
入力フォームで、UIの表示動作を選択できる MUST。デフォルトは常駐表示モードである MUST。

#### Scenario: デフォルトは常駐表示モード
**Given** ユーザーが初めてブックマークレットを起動する
**When** 入力フォームが表示される
**Then** UI表示モードの選択肢は「常駐表示」がデフォルトで選択されている
**And** 「自動非表示」も選択可能

---

### Requirement: 浮動コントロールパネルの表示状態切り替え
常駐表示モード時、浮動コントロールパネルは3段階の表示状態を持つ MUST。初期表示はフル表示であり、切り替えサイクルは「フル→最小化→ステータス→フル」である MUST。

#### Scenario: 初期表示はフル表示状態
**Given** 常駐表示モードでスクロールが開始される
**When** 浮動コントロールパネルが表示される
**Then** 初期状態は「フル表示」（ステータス + コントロールボタン表示）である
**And** 画面右下の固定位置に配置される

#### Scenario: アイコンタップで最小化に切り替え
**Given** 浮動コントロールパネルが「フル表示」状態で表示されている
**When** ユーザーがアイコンをタップする
**Then** 「最小化」状態に切り替わる
**And** アイコンのみが表示される（36x36px程度）

#### Scenario: 最小化からステータス表示に切り替え
**Given** 浮動コントロールパネルが「最小化」状態で表示されている
**When** ユーザーがアイコンをタップする
**Then** 「ステータス表示」状態に切り替わる
**And** アイコンに加えて現在のスレッド日時、速度、再生/一時停止状態が表示される
**And** 表示領域は横長に拡大する（例: 200x40px程度）

#### Scenario: ステータス表示からフル表示に戻る
**Given** 浮動コントロールパネルが「ステータス表示」状態で表示されている
**When** ユーザーがアイコンをタップする
**Then** 「フル表示」状態に戻る
**And** ステータス情報に加えて、再生/一時停止ボタン、速度+ボタン、速度-ボタンが表示される
**And** 表示領域はさらに拡大する（例: 200x80px程度）

---

### Requirement: ステータス情報のリアルタイム更新
浮動コントロールパネルのステータス表示は、スクロール状態に応じてリアルタイムで更新される MUST。準備完了メッセージは操作方法を明示し、自動タイマーでは消えないが、ユーザーが再生を開始した時点でクリアされる MUST。

#### Scenario: 準備完了メッセージの表示と維持
**Given** 常駐表示モードで起動時に一時停止状態で開始される
**When** 準備が完了する
**Then** 浮動コントロールパネルに「準備完了、▶ボタンまたはxキーで再生開始」と表示される
**And** メッセージは自動タイマーでは消えない（常駐表示のため、ユーザーが操作するまで表示され続ける）

#### Scenario: 再生開始時にメッセージをクリア
**Given** 浮動コントロールパネルに準備完了メッセージが表示されている
**And** スクロールが一時停止状態である
**When** ユーザーが▶ボタンまたはxキーで再生を開始する
**Then** 準備完了メッセージが非表示になる
**And** 通常のステータス情報のみが表示される
**And** 再生状態が「再生中」に変わる

---

### Requirement: UIの破棄とクリーンアップ
スクロール終了時、浮動コントロールパネルは適切に破棄される MUST。再実行時は新しいパネルが初期状態（フル表示）で生成される MUST。

#### Scenario: 再実行時のUI再生成
**Given** 浮動コントロールパネルが表示されている
**When** ユーザーがブックマークレットを再実行する
**Then** 既存のパネルが破棄される
**And** 新しいパネルが初期状態（フル表示）で生成される
**And** 前回のドラッグ位置はリセットされる

---

## ADDED Requirements

### Requirement: スマートフォン向けセットアップ手順

スマートフォンユーザー向けに、CDN経由でスクリプトを読み込む方式のセットアップ手順をドキュメント化する MUST。

#### Scenario: README.mdにCDN経由のブックマークレット登録方法を記載
**Given** ユーザーがスマートフォンでFutabaScrollerを利用したい
**When** README.mdのインストールセクションを読む
**Then** スマートフォン向けの専用セクションが存在する
**And** CDN（jsDelivr）経由でスクリプトを読み込むブックマークレットコードが記載されている
**And** ブックマークへの登録手順が日本語と英語で説明されている
